
# 합성과 유연한 설계.

-----------------------------------------------------------------------------------------------------------

> ## 상속을 합성으로 변경하기.

### 상속과 합성의 차이.
1. 상속은 정적인 관계이고, 합성은 동적인 관계이다.
   - 코드 작성 시점에 결정한 상속은 변경이 불가능하다.
   - 합성은 실행 시점(런타임)에 동적으로 변경할 수 있다.
   - 코드 재사용을 위해서는 객체 합성이 클래스 상속보다 더 좋은 방법이다.
2. 재사용 대상이 다르다.
   - 상속은 부모 클래스 안에 구현된 코드 자체를 재사용한다. (화이트박스 재사용)
   - 합성은 객체의 퍼블릭 인터페이스를 재사용한다. (블랙박스 재사용)
   - 결합도를 낮출 수 있다.

### 합성을 통해 해결할 수 있는 상속의 문제점.
1. 불필요한 인터페이스 상속 문제.
2. 메서드 오버라이딩의 오작용 문제.
3. 부모 클래스와 자식 클래스의 동시 수정 문제.

### 포워딩 메서드.
- 인스턴스 메서드에서 내부의 다른 인스턴스의 메서드를 호출하게 만드는 방법.

### 몽키 패치 Monkey Patch.
- 현재 실행 중인 환경에만 영향을 미치도록 지역적으로 코드를 수정하거나 확장하는 것을 가리킨다.

-----------------------------------------------------------------------------------------------------------

> ## 상속으로 인한 조합의 폭발적인 증가.

### 상속으로 인해 결합도가 높아졌을 때 문제.
- 하나의 기능을 추가하거나 수정하기 위해 불필요하게 많은 수의 클래스를 추가하거나 수정해야 한다.
- 단일 상속만 지원하는 언어에서는 상속으로 인해 오히려 중복 코드의 양이 늘어날 수 있다.

### 추상 메서드와 훅 메서드.
- 개방-폐쇄 원칙을 만족하는 방법은 부모 클래스에 새로운 추상 메서드를 추가하고 부모 클래스의 다른 메서드 안에서 호출하는 것이다.
- 자식 클래스는 추상 메서드를 오버라이딩하고 자신만의 로직을 구현해서 부모 클래스에서 정의한 플로우에 개입할 수 있게 된다.
- 추상 메서드의 단점은 상속 계층에 속하는 모든 자식 클래스가 추상 메서드를 오버라이딩해야 한다는 것이다.
- 훅 메서드 : 추상 메서드와 동일하게 자식 클래스에서 오버라이딩할 의도로 메서드를 추가했지만 편의를 위해 기본 구현을 제공하는 메서드.

### 클래스 폭발 class explosion.
- 조합의 폭발(combination explosion)이라고 부르기도 한다.
- 상속의 남용으로 하나의 기능을 추가하기 위해 필요 이상으로 많은 수의 클래스가 추가해야 하는 경우.
- 이 문제를 해결할 수 있는 최선의 방법은 상속을 포기하는 것이다.

-----------------------------------------------------------------------------------------------------------

> ## 합성 관계로 변경하기.

### 합성 특징.
- 합성은 컴파일타임 관계를 런타임 관계로 변경함으로써 클래스 폭발 문제를 해결한다.
- 컴파일 의존성에 속박되지 않고 다양한 방식의 런타임 의존성을 구성할 수 있다.
- 컴파일타임 의존성과 런타임 의존성의 거리가 멀어질수록 설계는 유연해진다.
- 컴파일타임 의존성과 런타임 의존성의 거리가 멀어질수록 설계의 복잡도가 상승해 코드를 이해하기 어려워진다.

### 정리.
- 코드를 재사용하면서도 건전한 결합도를 유지할 수 있는 더 좋은 방법은 합성을 이용하는 것이다.
- 상속이 구현을 재사용하는 데 비해 합성은 객체의 인터페이스를 재사용한다.

### 구현 상속과 인퍼테이스 상속.
- 상속은 구현 상속과 인터페이스 상속 두 가지로 나누어서 생각해야 한다.
- 이 두가지 상속에 대해서는 13장에서 자세히 다룬다.

-----------------------------------------------------------------------------------------------------------

> ## 믹스인.

### 믹스인 mixin.
- 객체를 생성할 때 코드 일부를 클래스 안에 섞어 넣어 재사용하는 기법을 가리키는 용어다.
- 컴파일 시점에 필요한 코드 조각을 조합하는 재사용 방법이다.
- 믹스인은 Flavors라는 언어에서 처음으로 도입됐고 CLOS에 의해 대중화됐다.

### 트레이트 조합 trait composition.
- 믹스인하려는 대상 클래스의 부모 클래스가 존재하는 경우 부모 클래스는 extends를 이용해 상속받고, 트레이트는 with를 이용해 믹스인하는 방법.

### 선형화.
- 믹스인한 클래스와 트레이트 중 어떤 메서드를 호출할지 결정하는 방식.

### 선형화 규칙.
1. 항상 맨 앞에는 구현한 클래스 자기 자신이 위치한다.
2. 그 다음에는 트레이트를 위치시킨다.
3. 그 다음에는 왼쪽 방향으로 가면서 순서대로 위치시킨다.

### 믹스인 특징.
- 믹스인은 특정한 클래스의 메서드를 재사용하고 기능을 확장하기 위해 사용된다.
- 믹스인은 상속 계층 안에서 확장한 클래스보다 더 하위에 위치하게 된다. (믹스인은 대상 클래스의 자식 클래스처럼 사용된다)
- 그래서 추상 서브클래스(abstract subclass)라고 부르기도 한다.

### 쌓을 수 있는 변경 stackable modification.
- 특정한 클래스에 대한 변경 또는 확장을 독립적으로 구현한 후 필요한 시점에 차례대로 추가할 수 있다.


























