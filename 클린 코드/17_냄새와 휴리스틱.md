
# 냄새와 휴리스틱

------------------------------------------------------------------------------------------------------------------------

> ## 개요

### 개요
- 이번 장에서는 리팩터링을 해야 되는 코드들에 대해서 얘기해보자

------------------------------------------------------------------------------------------------------------------------

> ## 주석

### 부적절한 정보
- 다른 시스템에 저장할 정보는 주석으로 적절하지 못하다 (예 : 변경 이력)


### 쓸모 없는 주석
- 오래된 주석, 엉뚱한 주석, 잘못된 주석은 더 이상 쓸모가 없다
- 쓸모 없어질 주석은 아예 달지 않는 편이 가장 좋다
- 쓸모 없어진 주석은 재빨리 삭제하는 것이 좋다


### 중복된 주석
- 코드만으로 충분한데 추가적으로 설명하는 주석이 중복된 주석이다


### 성의 없는 주석
- 주석을 달 생각이면 시간을 들여 최대한 멋지게 작성한다


### 주석 처리된 코드
- 주석으로 처리된 코드를 발견하면 즉각 지워버려라! (코드 관리 시스템을 통해 관리하자)

------------------------------------------------------------------------------------------------------------------------

> ## 환경

### 여러 단계로 빌드해야 한다
- 빌드는 한 단계로 끝나야 한다


### 여러 단계로 테스트해야 한다
- 모든 단위 테스트는 한 명령으로 돌려야 한다

------------------------------------------------------------------------------------------------------------------------

> ## 함수

### 너무 많은 인수
- 함수에서 인수 개수는 작을수록 좋다


### 출력 인수
- 일반적으로 독자는 인수를 입력으로 간주한다
- 함수에서 뭔가의 상태를 변경해야 한다면함수가 속한 객체의 상태를 변경해라


### 플래그 인수
- boolean 인수는 함수가 여러 기능을 수행한다는 명백한 증거다
- 플래그 인수는 혼란을 초래하므로 피해야 마땅하다


### 죽은 함수
- 아무도 호출하지 않는 함수는 삭제한다

------------------------------------------------------------------------------------------------------------------------

> ## 일반

### 한 소스 파일에 여러 언어를 사용한다
- 이상적으로는 소스 파일 하나에 언어 하나만 사용하는 방식이 가장 좋다
- 현실적으로는 여러 언어 사용이 불가피하기 때문에 최대한 줄이도록 애써야 한다


### 당연한 동작을 구현하지 않는다
- 함수나 클래스는 다른 프로그래머가 당연하게 여길 만한 동작과 기능을 제공해야 한다
- 당연한 동작을 구현하지 않으면 읽는 사람이 함수 기능을 직관적으로 예상하기 어렵다


### 경계를 올바로 처리하지 않는다
- 코드는 항상 올바르게 동작해야 한다
- 모든 경계 조건을 찾아내고, 모든 경계 조건을 테스트하는 테스트 케이스를 작성하라


### 안전 절차 무시
- 안전 절차를 무시하면 위험하다


### 중복 DRY Don't Repeat Yourself
- 코드에서 중복을 발견할 때마다 추상화할 기회로 간주하라
- 상황에 따라 메서드 추출, 전략 패턴, 템플릿 메서드 패턴, 다형성 등을 활용하여 중복을 줄일 수 있다


### 추상화 수준이 올바르지 못하다
- 기초 클래스에 구현 정보를 작성하지 말아라


### 기초 클래스가 파생 클래스에 의존한다
- 일반적으로 기초 클래스는 파생 클래스에 대해 아예 몰라야 한다


### 과도한 정보
- 잘 정의된 인터페이스는 많은 함수를 제공하지 않는다 (결합도가 낮다)
- 우수한 개발자는 인터페이스에 노출할 함수를 제한할 줄 알아야 한다


### 죽은 코드
- 죽은 코드를 발견하면 시스템에서 제거하라


### 수직 분리
- 변수와 함수는 사용되는 위치에 가깝게 정의한다
- 지역 변수는 처음으로 사용하기 직전에 선언하며 수직으로 가까운 곳에 위치해야 한다
- 비공개 함수는 호출한 직후에 정의한다


### 일관성 부족
- 어떤 개념을 특정 방식으로 구현했다면 유사한 개념도 같은 방식으로 구현한다
- 표기법은 신중하게 선택하며, 일단 선택한 표기법은 신중하게 따른다


### 인위적 결합
- 서로 무관한 개념을 인위적으로 결합하지 않는다


### 기능 욕심
- 클래스 메서드는 자기 클래스의 변수와 함수에 관심을 가져야 한다 (다른 클래스의 변수와 함수에 관심을 가져서는 안된다)


### 모호한 의도
- 코드를 짤 때는 의도를 최대한 분명히 밝힌다


### 부적잘한 static 함수
- 반드시 static 함수로 정의해야겠다면 재정의할 가능성이 없는지 확인한 후 작성한다


### 알고리즘을 이해하라
- 구현이 끝났다고 선언하기 전에 함수가 돌아가는 방식을 확실히 이해하는지 확인하라


### 논리적 의존성은 물리적으로 드러내라
- 한 모듈이 다른 모듈에 의존한다면 물리적인 의존성도 있어야 한다


### 매직 숫자는 명명된 상수로 교체하라
- 매직 숫자는 의미가 분명하지 않은 토큰을 모두 가리킨다


### 정확하라
- 코드에서 뭔가를 결정할 때는 정확히 결정한다


### 관례보다 구조를 사용하라
- 설계 결정을 강제할 때는 규칙보다 관례를 사용한다


### 조건을 캡슐화하라
- 조건의 의도를 분명히 밝히는 함수로 표현하라


### 부정 조건은 피하라
- 부정 조건은 긍정 조건보다 이해하기 어렵다


### 숨겨진 시간적인 결합
- 함수를 짤 때 함수 인수를 적절히 배치해 함수가 호출되는 순서를 명백히 드러낸다


### 일관성을 유지하라
- 코드 구조를 잡을 때는 이유를 고민하라. 그리고 그 이유를 코드 구조로 명백히 표현하라
- 구조에 일관성이 없어 보인다면 남들이 맘대로 바꿔도 괜찮다고 생각한다


### 경계 조건을 캡슐화하라
- 코드 여기저기에서 +1, -1와 같은 연산을 수행하지 않는다


### 함수는 추상화 수준을 한 단계만 내려가야 한다
- 함수 내 모든 문장은 추상화 수준이 동일해야 한다


### 추이적 탐색을 피하라
- 일반적으로 한 모듈은 주변 모듈을 모를수록 좋다
- 자신이 직접 사용하는 모듈만 알자

------------------------------------------------------------------------------------------------------------------------

> ## 자바

### 긴 import 목록을 피하고 와일드카드를 사용하라
    import package.*;


### 상수는 상속하지 않는다
- 인터페이스에 상수를 작성하고 구현체에서 구현체 변수처럼 사용하지 마라
- static 키워드를 사용해 "인터페이스.상수" 형태로 사용해라


### 상수 대 Enum
- 상수보다는 enum을 많이 활용하자
- enum은 메서드, 필드를 선언할 수 있어서 유연하고 서술적인 강력한 도구이다

------------------------------------------------------------------------------------------------------------------------

> ## 이름

### 서술적인 이름을 사용하라
- 이름은 성급하게 정하지 않는다
- 소프트웨어가 진화하면 의미도 변하므로 선택한 이름이 적합한지 자주 되돌아본다


### 적절한 추상화 수준에서 이름을 선택하라
- 구현을 드러내는 이름은 피하라
- 작업 대상 클래스나 함수가 위치하는 추상화 수준을 반영하는 이름을 선택하라


### 가능하다면 표준 명명법을 사용하라
- 기존 명명법을 사용하는 이름은 이해하기 더 쉽다
- 유비쿼터스 언어 ubiquitous language (프로젝트 내부에서 사용되는 약속된 표현)


### 명확한 이름
- 함수나 변수의 목적을 명확히 밝히는 이름을 선택한다


### 긴 범위는 긴 이름을 사용하라
- 범위가 길어지면 긴 이름을 서용한다


### 인코딩을 피하라
- 개발 환경에서 m_, f 와 같은 접두어를 붙이는 것을 의미한다


### 이름으로 부수 효과를 설명하라
- 함수, 변수, 클래스가 하는 일을 모두 기술하는 이름을 사용한다

------------------------------------------------------------------------------------------------------------------------

> ## 테스트

### 불충분한 테스트
- 테스트 케이스는 잠재적으로 깨질 만한 부분을 모두 테스트해야 한다


### 커버리지 도구를 사용하라!
- 커버리지 도구는 테스트가 빠뜨리는 공백을 알려준다
- 대다수 IDE는 테스트 커버리지를 시각적으로 표현한다


### 경계 조건을 테스트하라
- 경계 조건은 각별히 신경 써서 테스트한다


### 버그 주변은 철저히 테스트하라
- 버그는 서로 모이는 경향이 있다


### 테스트 커버리지 패턴을 살펴라
- 통과하는 테스트가 실행하거나 실행하지 않는 코드를 살펴보면 실패하는 테스트 케이스의 실패 원인이 드러난다


### 테스트는 빨라야 한다
- 느린 테스트 케이스는 실행하지 않게 된다


### 결론
- 규칙만 따른다고 깨끗한 코드가 얻어지지 않는다













